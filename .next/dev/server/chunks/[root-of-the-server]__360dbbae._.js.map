{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/PMLS/Videos/foodapp/app/api/solvers/assignment/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\n\nfunction hungarianAlgorithm(costMatrix: number[][]): { assignment: number[][]; totalCost: number } {\n  const n = costMatrix.length\n  const m = costMatrix[0]?.length || n\n\n  // Pad to square matrix if needed\n  const maxDim = Math.max(n, m)\n  const matrix = Array(maxDim)\n    .fill(0)\n    .map((_, i) =>\n      Array(maxDim)\n        .fill(0)\n        .map((_, j) => (i < n && j < m ? costMatrix[i][j] : Number.MAX_SAFE_INTEGER / 2)),\n    )\n\n  // Step 1: Subtract row minimums\n  for (let i = 0; i < maxDim; i++) {\n    const minRow = Math.min(...matrix[i])\n    if (minRow !== Number.MAX_SAFE_INTEGER / 2) {\n      for (let j = 0; j < maxDim; j++) {\n        if (matrix[i][j] !== Number.MAX_SAFE_INTEGER / 2) {\n          matrix[i][j] -= minRow\n        }\n      }\n    }\n  }\n\n  // Step 2: Subtract column minimums\n  for (let j = 0; j < maxDim; j++) {\n    const minCol = Math.min(...matrix.map((row) => row[j]))\n    if (minCol !== Number.MAX_SAFE_INTEGER / 2) {\n      for (let i = 0; i < maxDim; i++) {\n        if (matrix[i][j] !== Number.MAX_SAFE_INTEGER / 2) {\n          matrix[i][j] -= minCol\n        }\n      }\n    }\n  }\n\n  // Step 3: Greedy assignment on reduced matrix\n  const assignment = Array(maxDim)\n    .fill(0)\n    .map(() => Array(maxDim).fill(0))\n  const usedRows = new Set<number>()\n  const usedCols = new Set<number>()\n\n  for (let i = 0; i < maxDim; i++) {\n    for (let j = 0; j < maxDim; j++) {\n      if (matrix[i][j] === 0 && !usedRows.has(i) && !usedCols.has(j)) {\n        assignment[i][j] = 1\n        usedRows.add(i)\n        usedCols.add(j)\n        break\n      }\n    }\n  }\n\n  // Step 4: Calculate total cost from original matrix\n  let totalCost = 0\n  for (let i = 0; i < n; i++) {\n    for (let j = 0; j < m; j++) {\n      if (assignment[i][j] === 1) {\n        totalCost += costMatrix[i][j]\n      }\n    }\n  }\n\n  return { assignment, totalCost }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { num_riders, num_orders, cost_matrix } = body\n\n    const { assignment, totalCost } = hungarianAlgorithm(cost_matrix)\n\n    const assignments = []\n    for (let i = 0; i < num_riders; i++) {\n      for (let j = 0; j < num_orders; j++) {\n        if (assignment[i][j] === 1) {\n          assignments.push({\n            ambulance: i + 1,\n            emergency: j + 1,\n            cost: cost_matrix[i][j],\n          })\n        }\n      }\n    }\n\n    return NextResponse.json({\n      status: \"Optimal\",\n      total_cost: totalCost,\n      assignments: assignments,\n      is_balanced: num_riders === num_orders,\n    })\n  } catch (error) {\n    return NextResponse.json(\n      { status: \"Error\", error_message: String(error), total_cost: null, assignments: null },\n      { status: 400 },\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,SAAS,mBAAmB,UAAsB;IAChD,MAAM,IAAI,WAAW,MAAM;IAC3B,MAAM,IAAI,UAAU,CAAC,EAAE,EAAE,UAAU;IAEnC,iCAAiC;IACjC,MAAM,SAAS,KAAK,GAAG,CAAC,GAAG;IAC3B,MAAM,SAAS,MAAM,QAClB,IAAI,CAAC,GACL,GAAG,CAAC,CAAC,GAAG,IACP,MAAM,QACH,IAAI,CAAC,GACL,GAAG,CAAC,CAAC,GAAG,IAAO,IAAI,KAAK,IAAI,IAAI,UAAU,CAAC,EAAE,CAAC,EAAE,GAAG,OAAO,gBAAgB,GAAG;IAGpF,gCAAgC;IAChC,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,IAAK;QAC/B,MAAM,SAAS,KAAK,GAAG,IAAI,MAAM,CAAC,EAAE;QACpC,IAAI,WAAW,OAAO,gBAAgB,GAAG,GAAG;YAC1C,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,IAAK;gBAC/B,IAAI,MAAM,CAAC,EAAE,CAAC,EAAE,KAAK,OAAO,gBAAgB,GAAG,GAAG;oBAChD,MAAM,CAAC,EAAE,CAAC,EAAE,IAAI;gBAClB;YACF;QACF;IACF;IAEA,mCAAmC;IACnC,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,IAAK;QAC/B,MAAM,SAAS,KAAK,GAAG,IAAI,OAAO,GAAG,CAAC,CAAC,MAAQ,GAAG,CAAC,EAAE;QACrD,IAAI,WAAW,OAAO,gBAAgB,GAAG,GAAG;YAC1C,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,IAAK;gBAC/B,IAAI,MAAM,CAAC,EAAE,CAAC,EAAE,KAAK,OAAO,gBAAgB,GAAG,GAAG;oBAChD,MAAM,CAAC,EAAE,CAAC,EAAE,IAAI;gBAClB;YACF;QACF;IACF;IAEA,8CAA8C;IAC9C,MAAM,aAAa,MAAM,QACtB,IAAI,CAAC,GACL,GAAG,CAAC,IAAM,MAAM,QAAQ,IAAI,CAAC;IAChC,MAAM,WAAW,IAAI;IACrB,MAAM,WAAW,IAAI;IAErB,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,IAAK;QAC/B,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,IAAK;YAC/B,IAAI,MAAM,CAAC,EAAE,CAAC,EAAE,KAAK,KAAK,CAAC,SAAS,GAAG,CAAC,MAAM,CAAC,SAAS,GAAG,CAAC,IAAI;gBAC9D,UAAU,CAAC,EAAE,CAAC,EAAE,GAAG;gBACnB,SAAS,GAAG,CAAC;gBACb,SAAS,GAAG,CAAC;gBACb;YACF;QACF;IACF;IAEA,oDAAoD;IACpD,IAAI,YAAY;IAChB,IAAK,IAAI,IAAI,GAAG,IAAI,GAAG,IAAK;QAC1B,IAAK,IAAI,IAAI,GAAG,IAAI,GAAG,IAAK;YAC1B,IAAI,UAAU,CAAC,EAAE,CAAC,EAAE,KAAK,GAAG;gBAC1B,aAAa,UAAU,CAAC,EAAE,CAAC,EAAE;YAC/B;QACF;IACF;IAEA,OAAO;QAAE;QAAY;IAAU;AACjC;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,UAAU,EAAE,UAAU,EAAE,WAAW,EAAE,GAAG;QAEhD,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,GAAG,mBAAmB;QAErD,MAAM,cAAc,EAAE;QACtB,IAAK,IAAI,IAAI,GAAG,IAAI,YAAY,IAAK;YACnC,IAAK,IAAI,IAAI,GAAG,IAAI,YAAY,IAAK;gBACnC,IAAI,UAAU,CAAC,EAAE,CAAC,EAAE,KAAK,GAAG;oBAC1B,YAAY,IAAI,CAAC;wBACf,WAAW,IAAI;wBACf,WAAW,IAAI;wBACf,MAAM,WAAW,CAAC,EAAE,CAAC,EAAE;oBACzB;gBACF;YACF;QACF;QAEA,OAAO,qKAAY,CAAC,IAAI,CAAC;YACvB,QAAQ;YACR,YAAY;YACZ,aAAa;YACb,aAAa,eAAe;QAC9B;IACF,EAAE,OAAO,OAAO;QACd,OAAO,qKAAY,CAAC,IAAI,CACtB;YAAE,QAAQ;YAAS,eAAe,OAAO;YAAQ,YAAY;YAAM,aAAa;QAAK,GACrF;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}